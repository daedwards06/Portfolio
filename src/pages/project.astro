---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const featured = projects.find((p) => p.data.featured) ?? projects[0];
const FeaturedContent = featured ? (await featured.render()).Content : null;
---

<BaseLayout
	title="Project â€” MARS"
	description="MARS case study and links."
	path="/project"
>
	<header class="header">
		<h1>Project</h1>
		<p class="muted">MARS is featured at launch. New projects are drop-in Markdown files.</p>
	</header>

	{featured ? (
		<article class="card">
			<h2>{featured.data.title}</h2>
			<p>
				{featured.body.trim().split('\n')[0]}
			</p>

			<div class="btnrow">
				{featured.data.links?.demo ? (
					<a class="btn primary" href={featured.data.links.demo} target="_blank" rel="noreferrer">
						Live demo
					</a>
				) : null}
				{featured.data.links?.repo ? (
					<a class="btn" href={featured.data.links.repo} target="_blank" rel="noreferrer">
						Repository
					</a>
				) : null}
			</div>

			<hr />
			{FeaturedContent ? <FeaturedContent /> : null}
		</article>
	) : (
		<p>No projects found yet.</p>
	)}
</BaseLayout>
